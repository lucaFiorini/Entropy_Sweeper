(()=>{"use strict";var e={};(e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})})(e);class t{row=0;col=0;isMine=!1;isRevealed=!1;isFlagged=!1;adjacentMines=0;adjacentCells=8;constructor(e,t,s=!1,i=!1,n=!1,o=0,r=8){this.row=e,this.col=t,this.isMine=s,this.isRevealed=i,this.isFlagged=n,this.adjacentMines=o,this.adjacentCells=r}toString(){return this.isRevealed?this.isMine?"*":this.adjacentMines.toString():this.isFlagged?"F":"."}get isEmpty(){return!this.isMine&&!this.isRevealed&&!this.isFlagged}get isHidden(){return!this.isRevealed&&!this.isFlagged}get isVisible(){return this.isRevealed||this.isFlagged}get isExploded(){return this.isRevealed&&this.isMine}}const s=class{board=[];rows=0;cols=0;mineCount=0;isFirstCellRevealed=!0;gameOver=!1;won=!1;constructor(e,t,s){if(!Number.isInteger(e)||!Number.isInteger(t)||!Number.isInteger(s)||e<=0||t<=0||s<0||s>=e*t)throw new Error("Invalid board size or mine count");this.rows=e,this.cols=t,this.mineCount=s,this.#e(),this.#t(),this.#s()}#e(){this.board=[];for(let e=0;e<this.rows;e++){this.board[e]=[];for(let s=0;s<this.cols;s++)this.board[e][s]=new t(e,s)}this.gameOver=!1}#t(){let e=0;for(;e<this.mineCount;){const t=Math.floor(Math.random()*this.rows),s=Math.floor(Math.random()*this.cols),i=this.board[t][s];i.isMine||(i.isMine=!0,e++)}}#s(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.cols;t++){const s=this.board[e][t];if(s.isMine)continue;let i=0;for(let s=-1;s<=1;s++)for(let n=-1;n<=1;n++){if(0===s&&0===n)continue;const o=e+s,r=t+n;o>=0&&o<this.rows&&r>=0&&r<this.cols&&this.board[o][r].isMine&&i++}s.adjacentMines=i}}revealCell(e,t){if(this.won||this.gameOver)return{mineHit:!1,revealed:0};if(e<0||e>=this.rows||t<0||t>=this.cols)return{mineHit:!1,revealed:0};const s=this.board[e][t];if(s.isRevealed||s.isFlagged)return{mineHit:!1,revealed:0};if(this.isFirstCellRevealed)for(this.isFirstCellRevealed=!1;s.isMine;)s.isMine=!1,this.#t(1),this.#s();this.board[e][t].isRevealed=!0;for(let s=-1;s<=1;s++)for(let i=-1;i<=1;i++){if(0===s&&0===i)continue;const n=e+s,o=t+i;n>=0&&n<this.rows&&o>=0&&o<this.cols&&this.board[n][o].adjacentCells--}if(this.board[e][t].isMine)return this.gameOver=!0,{mineHit:!0,revealed:1};let i=1;if(0===this.board[e][t].adjacentMines)for(let s=-1;s<=1;s++)for(let n=-1;n<=1;n++)0===s&&0===n||(i+=this.revealCell(e+s,t+n).revealed);return this.getRemainingMines()<=0&&(this.won=!0),{mineHit:!1,revealed:i}}boardToString(){let e="";for(let t=0;t<this.rows;t++){let s="";for(let e=0;e<this.cols;e++)this.board[t][e].isRevealed?this.board[t][e].isMine?s+="* ":s+=this.board[t][e].adjacentMines+" ":this.board[t][e].isFlagged?s+="F ":s+=". ";e+=s.trim()+"\n"}return e.trim()}printBoard(){console.log(this.boardToString())}flagCell(e,t){if(this.gameOver)return!1;if(e<0||e>=this.rows||t<0||t>=this.cols)return!1;const s=this.board[e][t];if(s.isRevealed)return!1;s.isFlagged=!s.isFlagged,s.isFlagged&&this.getRemainingMines()<=0&&(this.won=!0)}getCell(e,t){return e<0||e>=this.rows||t<0||t>=this.cols?null:this.board[e][t]}getRemainingMines(){let e=0,t=0;for(let s=0;s<this.rows;s++)for(let i=0;i<this.cols;i++)this.board[s][i].isMine&&t++,this.board[s][i].isFlagged&&e++;return Math.max(0,t-e)}getBoard(){return this.board}getSize(){return{rows:this.rows,cols:this.cols}}},i=class{constructor(){this.cells=[],this.hiddenNeighbors=[]}addCell(e){this.cells.some((t=>t.row===e.row&&t.col===e.col))||this.cells.push(e)}getCells(){return this.cells}setHiddenNeighbors(e){this.hiddenNeighbors=e}getHiddenNeighbors(e){if(this.hiddenNeighbors&&this.hiddenNeighbors.length>0)return this.hiddenNeighbors;const t=new Set;for(const{row:s,col:i}of this.cells)for(let n=-1;n<=1;n++)for(let o=-1;o<=1;o++){if(0===n&&0===o)continue;const r=s+n,l=i+o;if(r>=0&&r<e.rows&&l>=0&&l<e.cols){const s=e.getCell(r,l);s.isRevealed||s.isFlagged||t.add(`${r},${l}`)}}return this.hiddenNeighbors=Array.from(t).map((e=>e.split(",").map(Number))),this.hiddenNeighbors}},n=class{entropy=0;minesweeper=null;chains=[];constructor(e){if(!(e instanceof s))throw new Error("Invalid Minesweeper instance provided");this.minesweeper=e,this.entropy=0}calculateEntropy(){this.calculateChains(),this.entropy=0,this.chains.forEach(((t,s)=>{const{validCount:i,entropy:n,hiddenTileCount:o}=(0,e.countValidStates)(t,this.minesweeper);console.log(`Chain ${s+1}:`),console.log(`  Hidden tiles: ${o}`),console.log(`  Valid configurations: ${i}`),console.log(`  Entropy (bits): ${n.toFixed(4)}`),this.entropy+=n})),console.log(`\nTotal Entropy: ${this.entropy.toFixed(4)} bits`)}printChains(){0!==this.chains.length?this.chains.forEach(((e,t)=>{console.log(`Chain ${t+1}:`),e.print(this.minesweeper)})):console.log("No chains found.")}calculateChains(){this.chains=[];const e=Array.from({length:this.minesweeper.rows},(()=>Array(this.minesweeper.cols).fill(!1))),t=e=>e.isRevealed&&e.adjacentMines>0,s=(e,t)=>{const s=[];for(let i=-1;i<=1;i++)for(let n=-1;n<=1;n++){if(0===i&&0===n)continue;const o=e+i,r=t+n;if(o>=0&&o<this.minesweeper.rows&&r>=0&&r<this.minesweeper.cols){const e=this.minesweeper.getCell(o,r);e.isRevealed||e.isFlagged||s.push([o,r])}}return s},n=(e,t)=>{const s=new Set,i=[],n=e=>{const o=`${e[0]},${e[1]}`;if(s.has(o))return;s.add(o),i.push({row:e[0],col:e[1]});let r=t.get(o)||[];for(const e of r)n(e)};return n(e),i};for(let o=0;o<this.minesweeper.rows;o++)for(let r=0;r<this.minesweeper.cols;r++)if(t(this.minesweeper.getCell(o,r))&&!e[o][r]){const l=new Map,a=[[o,r]];for(e[o][r]=!0;a.length>0;){const[i,n]=a.shift(),o=s(i,n);for(const[s,r]of o)for(let o=-1;o<=1;o++)for(let d=-1;d<=1;d++){if(0===o&&0===d)continue;const h=s+o,c=r+d;h>=0&&h<this.minesweeper.rows&&c>=0&&c<this.minesweeper.cols&&t(this.minesweeper.getCell(h,c))&&(l.has(`${i},${n}`)||l.set(`${i},${n}`,[]),l.get(`${i},${n}`).push([h,c]),e[h][c]||(a.push([h,c]),e[h][c]=!0))}}const d=n([o,r],l);if(d.length>0){const e=new i;d.forEach((t=>e.addCell(t))),this.chains.push(e)}}}};document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("game-board"),t=document.getElementById("reset-button"),i=document.getElementById("settings-form");let o,r,l=10,a=10,d=10;function h(){try{o=new s(l,a,d),r=new n(o),function(){e.innerHTML="",e.style.gridTemplateColumns=`repeat(${a}, 30px)`;for(let t=0;t<l;t++)for(let s=0;s<a;s++){const i=document.createElement("div");i.className="cell",i.dataset.row=t,i.dataset.col=s,i.addEventListener("click",(()=>c(t,s))),i.addEventListener("contextmenu",(e=>{e.preventDefault(),g(t,s)})),e.appendChild(i)}}()}catch(e){alert("Failed to initialize game: "+e.message)}}function c(e,t){o.gameOver||o.getCell(e,t).isFlagged||(o.revealCell(e,t).mineHit?(alert("Game Over!"),function(){for(let e=0;e<l;e++)for(let t=0;t<a;t++)o.getCell(e,t).isMine&&u(e,t)}()):(console.clear(),r.calculateChains(),r.printChains(),function(){for(let e=0;e<l;e++)for(let t=0;t<a;t++)u(e,t)}()))}function g(e,t){o.gameOver||o.getCell(e,t).isRevealed||(o.flagCell(e,t),u(e,t))}function u(e,t){const s=o.getCell(e,t),i=document.querySelector(`.cell[data-row="${e}"][data-col="${t}"]`);s.isRevealed?(i.classList.add("revealed"),s.isMine?(i.classList.add("mine"),i.textContent="*"):i.textContent=s.adjacentMines>0?s.adjacentMines:""):s.isFlagged?(i.classList.add("flagged"),i.textContent="F"):(i.classList.remove("revealed","mine","flagged"),i.textContent="")}i.addEventListener("submit",(e=>{e.preventDefault(),l=parseInt(document.getElementById("rows").value),a=parseInt(document.getElementById("cols").value),d=parseInt(document.getElementById("mines").value),h()})),t.addEventListener("click",h),h()}))})();
//# sourceMappingURL=bundle.js.map